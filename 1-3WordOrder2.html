<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>문장 순서 배열</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --glass: rgba(255,255,255,0.22);
      --glass-strong: rgba(255,255,255,0.35);
      --chip: rgba(255,255,255,0.9);
      --accent: #42a5f5;
      --accent2: #7c4dff;
      --answer: #ffd54f;
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:24px;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
      background: linear-gradient(135deg,#8EC5FC 0%,#E0C3FC 100%);
      min-height:100vh; display:flex; flex-direction:column; align-items:center;
    }
    h1{color:#fff; text-shadow:0 2px 6px rgba(0,0,0,.25); margin:6px 0 12px}
    .wrap{
      width:100%; max-width:820px;
      background: var(--glass);
      backdrop-filter: blur(12px);
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.15);
    }
    .topbar{
      display:flex; align-items:center; gap:10px; margin-bottom:12px; color:#fff; font-weight:700
    }
    .progress{flex:1; height:12px; border-radius:12px; background:rgba(255,255,255,.35); overflow:hidden}
    .progress-bar{height:100%; width:0%; background:linear-gradient(90deg,var(--accent),var(--accent2)); transition:width .3s}
    .card{
      background: var(--glass-strong); border-radius:16px; padding:16px; color:#fff; margin-bottom:14px; text-align:center; font-weight:700
    }
    .note{opacity:.9; font-weight:500; margin-top:6px}
    .row{display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:10px 0}
    .chip{
      background: var(--chip);
      border-radius: 22px; padding:10px 14px;
      font-weight:800; cursor:pointer; transition:.18s transform, .18s box-shadow;
      box-shadow: 0 2px 6px rgba(0,0,0,.1);
      user-select:none;
    }
    .chip:hover{transform:translateY(-2px)}
    .chip.used{opacity:.45; pointer-events:none}
    .answer .chip{ background: var(--answer) }
    .btns{display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:6px}
    button{
      background:#fff; border:none; border-radius:10px; padding:10px 14px; font-weight:800; cursor:pointer;
      box-shadow:0 2px 8px rgba(0,0,0,.12); transition:.15s transform
    }
    button:active{transform:scale(.98)}
    .feedback{min-height:26px; text-align:center; font-size:1.1rem; font-weight:800; color:#fff; margin-top:6px}
    @media (max-width:600px){
      .chip{font-size:.95rem; padding:9px 12px}
      .card{font-size:1rem}
    }
    @keyframes fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0 } }
  </style>
</head>
<body>
  <h1>문장 순서 배열</h1>
  <div class="wrap">
    <div class="topbar">
      <div id="counter">문제 1 / 5</div>
      <div class="progress"><div class="progress-bar" id="bar"></div></div>
    </div>

    <div class="card">
      <div id="prompt">문장을 올바르게 배열하세요</div>
      <div class="note">단어칩을 눌러 아래 답란으로 옮기세요. 답칩을 다시 누르면 제거됩니다.</div>
    </div>

    <div class="row choices" id="choices"></div>
    <div class="row answer" id="answer" aria-label="답란"></div>

    <div class="btns">
      <button id="undo">되돌리기</button>
      <button id="clear">지우기</button>
      <button id="shuffle">다시섞기</button>
      <button id="check">정답 확인</button>
    </div>

    <div class="feedback" id="feedback"></div>
  </div>

  <script>
    // ====== 데이터 ======
    const sentences = [
      "I like the school lunch.",
      "She will play basketball today.",
      "She will finish her homework.",
      "He did his homework yesterday.",
      "I joined the book club."
    ];

    // ====== 상태 ======
    let idx = 0;
    let words = [];
    let shuffled = [];

    // ====== 유틸 ======
    const el = (sel) => document.querySelector(sel);
    const makeChip = (text, onClick) => {
      const c = document.createElement('div');
      c.className = 'chip';
      c.textContent = text;
      c.onclick = onClick;
      return c;
    };
    const shuffle = (arr) => {
      const a = [...arr];
      for (let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    };

    // ====== 렌더 ======
    function render(){
      if(idx >= sentences.length){
        finishScreen();
        return;
      }
      words = sentences[idx].split(" ");
      shuffled = shuffle(words);

      el("#counter").textContent = `문제 ${idx+1} / ${sentences.length}`;
      el("#bar").style.width = `${(idx / sentences.length) * 100}%`;
      el("#feedback").textContent = "";
      el("#answer").innerHTML = "";
      el("#choices").innerHTML = "";

      shuffled.forEach(w=>{
        const chip = makeChip(w, ()=>{
          // choices -> answer (복제본)
          const ansChip = makeChip(w, ()=>{
            ansChip.remove(); // 답칩 클릭 시 제거
          });
          el("#answer").appendChild(ansChip);
          chip.classList.add("used");
        });
        el("#choices").appendChild(chip);
      });
    }

    // ====== 체크 ======
    function check(){
      const user = [...el("#answer").children].map(c=>c.textContent).join(" ");
      const correct = words.join(" ");
      if(user === correct){
        el("#feedback").textContent = "✅ 정답입니다!";
        setTimeout(()=>{ idx++; render(); }, 900);
      }else{
        el("#feedback").textContent = "❌ 틀렸습니다. 다시 시도해 보세요!";
      }
    }

    // ====== 완료 화면 ======
    function finishScreen(){
      el("#counter").textContent = "완료";
      el("#bar").style.width = "100%";
      el("#prompt").textContent = "🎉 모든 문제를 풀었습니다!";
      el("#choices").innerHTML = "";
      el("#answer").innerHTML = "";
      confetti(1800);
    }

    // ====== 버튼 동작 ======
    el("#undo").onclick = ()=>{
      const last = el("#answer").lastElementChild;
      if(!last) return;
      const text = last.textContent;
      last.remove();
      // choices의 해당 칩 사용 해제
      [...el("#choices").children].forEach(ch=>{
        if(ch.textContent===text) ch.classList.remove("used");
      });
    };

    el("#clear").onclick = ()=>{
      const usedTexts = [...el("#answer").children].map(c=>c.textContent);
      el("#answer").innerHTML = "";
      [...el("#choices").children].forEach(ch=>{
        if(usedTexts.includes(ch.textContent)) ch.classList.remove("used");
      });
      el("#feedback").textContent = "";
    };

    el("#shuffle").onclick = ()=>{
      // 현재 문장을 기준으로 다시 섞기
      const order = shuffle(words);
      el("#choices").innerHTML = "";
      order.forEach(w=>{
        const chip = makeChip(w, ()=>{
          const ansChip = makeChip(w, ()=> ansChip.remove());
          el("#answer").appendChild(ansChip);
          chip.classList.add("used");
        });
        el("#choices").appendChild(chip);
      });
      // 답란 초기화
      el("#answer").innerHTML = "";
      el("#feedback").textContent = "";
    };

    el("#check").onclick = check;

    // ====== 간단 콘페티 ======
    function confetti(ms=2000){
      const end = Date.now()+ms;
      (function frame(){
        const piece = document.createElement("div");
        piece.textContent = "🎉";
        piece.style.position = "fixed";
        piece.style.left = Math.random()*100 + "vw";
        piece.style.top = "-30px";
        piece.style.fontSize = (18+Math.random()*12) + "px";
        piece.style.animation = "fall 2s linear";
        piece.style.transform = `rotate(${Math.random()*360}deg)`;
        document.body.appendChild(piece);
        setTimeout(()=> piece.remove(), 2100);
        if(Date.now() < end) requestAnimationFrame(frame);
      })();
    }

    // 시작
    render();
  </script>
</body>
</html>
