<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì˜ì‘ íƒ€ì´í•‘</title>
  <style>
    body { font-family: Arial, sans-serif; background: linear-gradient(135deg,#d4fc79,#96e6a1); text-align:center; padding:30px; }
    .card { background: rgba(255,255,255,0.85); border-radius:15px; padding:20px; margin:20px auto; width:80%; max-width:600px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    h2 { font-size:22px; margin-bottom:15px; }
    input { width:90%; padding:10px; font-size:16px; border-radius:8px; border:1px solid #ccc; margin-bottom:10px; }
    button { padding:10px 20px; margin:5px; font-size:16px; border:none; border-radius:8px; cursor:pointer; background:#4caf50; color:#fff; }
    button:hover { background:#45a049; }
    .feedback { font-size:18px; margin-top:10px; font-weight:bold; }
    #retryBtn { display:none; background:#2196F3; }
    #retryBtn:hover { background:#1976D2; }
  </style>
</head>
<body>
  <h1>ì˜ì‘ íƒ€ì´í•‘</h1>
  <div class="card">
    <h2 id="question">ë¬¸ì œ 1.</h2>
    <input
      type="text"
      id="answerInput"
      placeholder="ì˜ì–´ë¡œ ì…ë ¥í•˜ì„¸ìš”"
      autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
    />
    <br />
    <button id="checkBtn" onclick="checkAnswer()">ì •ë‹µ í™•ì¸</button>
    <button id="clearBtn" onclick="clearInput()">ì§€ìš°ê¸°</button>
    <button id="retryBtn" onclick="retry()">ë‹¤ì‹œ í’€ê¸°</button>
    <div id="feedback" class="feedback"></div>
  </div>

  <script>
    const originalQuestions = [
      { text: "ê·¸ë…€ëŠ” ë‚˜ì˜ ë‹´ì„ì„ ìƒë‹˜ì´ë‹¤.", a: ["She is my homeroom teacher.", "She's my homeroom teacher"] },
      { text: "ê·¸ë“¤ì€ ë‚˜ì˜ í•™ê¸‰ì¹œêµ¬ë“¤ì´ë‹¤.", a: ["They are my classmates.", "They're my classmates"] },
      { text: "ë‚´ê°€ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê³¼ëª©ì€ ì˜ì–´ì´ë‹¤.", a: ["My favorite subject is English.", "My favorite subject's English"] },
      { text: "ê·¸ êµì‹¤ì€ ê¹¨ë—í•˜ë‹¤.", a: ["The classroom is clean.", "The classroom's clean"] },
      { text: "ë‚˜ëŠ” í•™êµì— ëŠ¦ì§€ ì•ŠëŠ”ë‹¤.", a: ["I am not late for school.", "I'm not late for school"] }
    ];

    let questions = [];
    let current = 0;

    // ë¬¸ìì—´ ì •ê·œí™”
    function normalize(str) {
      return str
        .trim()
        .replace(/[\u2018\u2019\u2032]/g, "'")
        .replace(/[\u201C\u201D\u2033]/g, '"')
        .replace(/\s+/g, " ")
        .replace(/[.!?]$/g, "")
        .toLowerCase();
    }

    function isCorrect(input, answers) {
      const normInput = normalize(input);
      return answers.some(a => normalize(a) === normInput);
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function showQuestion() {
      document.getElementById("question").innerText = 
        `ë¬¸ì œ ${current + 1}. ${questions[current].text}`;
      document.getElementById("answerInput").value = "";
      document.getElementById("feedback").innerText = "";
      document.getElementById("answerInput").focus();
    }

    function checkAnswer() {
      const input = document.getElementById("answerInput").value;
      const feedback = document.getElementById("feedback");

      if (isCorrect(input, questions[current].a)) {
        feedback.style.color = "blue";
        feedback.innerText = "ì •ë‹µì…ë‹ˆë‹¤! âœ…";
        current++;
        if (current < questions.length) {
          setTimeout(showQuestion, 700);
        } else {
          setTimeout(finishQuiz, 700);
        }
      } else {
        feedback.style.color = "red";
        feedback.innerText = "ì˜¤ë‹µì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ë³´ì„¸ìš”!";
      }
    }

    function clearInput() {
      document.getElementById("answerInput").value = "";
      document.getElementById("feedback").innerText = "";
      document.getElementById("answerInput").focus();
    }

    function finishQuiz() {
      document.getElementById("question").innerText = "ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰";
      document.getElementById("answerInput").style.display = "none";
      document.getElementById("checkBtn").style.display = "none";
      document.getElementById("clearBtn").style.display = "none";
      document.getElementById("feedback").innerText = "";
      document.getElementById("retryBtn").style.display = "inline-block";
    }

    function retry() {
      current = 0;
      questions = shuffle([...originalQuestions]); // ì„ê¸°
      document.getElementById("answerInput").style.display = "inline-block";
      document.getElementById("checkBtn").style.display = "inline-block";
      document.getElementById("clearBtn").style.display = "inline-block";
      document.getElementById("retryBtn").style.display = "none";
      showQuestion();
    }

    // ì²« ì‹¤í–‰
    window.onload = retry;
  </script>
</body>
</html>
