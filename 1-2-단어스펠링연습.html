<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ìŠ¤í ë§ ì…ë ¥ ì—°ìŠµ (ë¬´ì‘ìœ„ ë§¤ë²ˆ / íƒ€ì´í•‘ ì „ìš©)</title>
<style>
  :root{ --primary:#3498db; --ok:#2ecc71; --warn:#e67e22; --violet:#9b59b6; --text:#333; }
  *{ box-sizing:border-box; }
  body{
    font-family: Arial, "Noto Sans KR", system-ui, sans-serif;
    background:#f0f0f0; color:var(--text);
    min-height:100vh; margin:0;
    display:flex; align-items:center; justify-content:center; padding:24px;
  }
  #quiz-box{ background:#fff; width:min(520px, 96vw); text-align:center; padding:28px;
    border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,.12); }
  #title{ font-size:18px; color:#666; margin:0 0 6px; }
  #progress{ font-size:14px; color:#666; margin:0 0 14px; }
  #korean{ font-size:24px; font-weight:800; margin:12px 0 18px; line-height:1.25; }
  #answer{
    width:94%; font-size:18px; padding:11px 14px; text-align:center;
    border:2px solid var(--primary); border-radius:10px; outline:none;
  }
  .btns{ margin-top:16px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
  button{
    padding:10px 16px; border:none; border-radius:10px; color:#fff; font-size:15px;
    cursor:pointer; transition:transform .05s ease;
  }
  button:active{ transform:scale(.98); }
  #speak{ background:var(--ok); }
  #check{ background:var(--primary); }
  #next{ background:var(--warn); display:none; }
  #retry{ background:var(--violet); display:none; }
  #feedback{ margin-top:14px; font-weight:800; min-height:30px; }
  .muted{ color:#888; font-weight:500; font-size:13px; margin-top:6px; }
</style>
</head>
<body>
<div id="quiz-box" role="main">
  <div id="title">ìŠ¤í ë§ ì…ë ¥ ì—°ìŠµ</div>
  <div id="progress">ë¬¸ì œ 1 / 10</div>
  <div id="korean">ì˜ë¯¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>

  <form id="form" autocomplete="off" autocapitalize="off" spellcheck="false">
    <input id="answer" type="text" inputmode="latin" name="no-autofill"
           autocomplete="new-password" autocapitalize="off"
           aria-label="ì˜ì–´ ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" placeholder="ì˜ì–´ ë‹¨ì–´ë¥¼ ì§ì ‘ íƒ€ì´í•‘í•˜ì„¸ìš”" />
    <button type="submit" style="display:none"></button>
  </form>

  <div class="btns">
    <button id="speak" type="button">ğŸ”Š ë°œìŒ ë“£ê¸°</button>
    <button id="check" type="button">ì •ë‹µ í™•ì¸</button>
    <button id="next" type="button">ë‹¤ìŒ ë¬¸ì œ</button>
    <button id="retry" type="button">ë‹¤ì‹œ í’€ê¸°</button>
  </div>

  <div id="feedback"></div>
  <div class="muted">â€» ìë™ì™„ì„±/ë¶™ì—¬ë„£ê¸°/ë“œë˜ê·¸ ì…ë ¥ì€ ì œí•œë©ë‹ˆë‹¤. ì§ì ‘ íƒ€ì´í•‘í•˜ì„¸ìš”.</div>
</div>

<script>
/* ====== ë‹¨ì–´ ëª©ë¡ ====== */
const words = [
  {en:"homeroom teacher", ko:"ë‹´ì„ì„ ìƒë‹˜"},
  {en:"classmate",        ko:"í•™ê¸‰ì¹œêµ¬"},
  {en:"favorite",         ko:"ì¢‹ì•„í•˜ëŠ”"},
  {en:"subject",          ko:"ê³¼ëª©"},
  {en:"English",          ko:"ì˜ì–´"},
  {en:"math",             ko:"ìˆ˜í•™"},
  {en:"classroom",        ko:"êµì‹¤"},
  {en:"clean",            ko:"ê¹¨ë—í•œ"},
  {en:"art",              ko:"ë¯¸ìˆ , ì˜ˆìˆ "},
  {en:"small",            ko:"ì‘ì€"}
];

/* ====== ìƒíƒœ ====== */
let order = [...Array(words.length).keys()];
let currentIndex = 0;
let attempts = 0;
let typedByKeyboard = false;
let composing = false;

/* ====== ìš”ì†Œ (letë¡œ ì„ ì–¸! reset í›„ ì¬ë°”ì¸ë”©) ====== */
let $korean, $answer, $feedback, $progress, $checkBtn, $nextBtn, $retryBtn;

/* ====== ìœ í‹¸ ====== */
function cur(){ return words[ order[currentIndex] ]; }
function shuffle(arr){
  for(let i=arr.length-1; i>0; i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}

/* ====== ë°”ì¸ë”© ====== */
function bindRuntimeElements(){
  $korean   = document.getElementById("korean");
  $answer   = document.getElementById("answer");
  $feedback = document.getElementById("feedback");
  $progress = document.getElementById("progress");
  $checkBtn = document.getElementById("check");
  $nextBtn  = document.getElementById("next");
  $retryBtn = document.getElementById("retry");

  document.getElementById("speak").addEventListener("click", ()=> speak(cur().en));
  $checkBtn.addEventListener("click", checkAnswer);
  document.getElementById("form").addEventListener("submit", (e)=>{ e.preventDefault(); checkAnswer(); });
  $nextBtn.addEventListener("click", nextQuestion);
  $retryBtn.addEventListener("click", resetQuiz);

  // ì…ë ¥ ì œí•œ
  $answer.addEventListener("paste", e => { e.preventDefault(); showWarn("ğŸ“ ë¶™ì—¬ë„£ê¸°ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); });
  $answer.addEventListener("drop",  e => { e.preventDefault(); showWarn("ğŸ“ ë“œë˜ê·¸&ë“œë¡­ ì…ë ¥ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); });
  $answer.addEventListener("contextmenu", e => e.preventDefault());
  $answer.addEventListener("compositionstart", ()=> composing = true);
  $answer.addEventListener("compositionend",   ()=> composing = false);
  $answer.addEventListener("keydown", (e)=>{
    if(composing) return;
    const k = e.key;
    const isTypingKey = (k.length===1)||k==="Backspace"||k==="Spacebar"||k===" "||k==="Delete";
    if(isTypingKey) typedByKeyboard = true;
  });
  $answer.addEventListener("focus", ()=>{
    setTimeout(()=> $answer.setSelectionRange($answer.value.length, $answer.value.length), 0);
  });
}

/* ====== ë¬¸ì œ í‘œì‹œ ====== */
function loadQuestion(){
  const w = cur();
  $korean.textContent = w.ko;               // â˜… í•œêµ­ì–´ ëœ» í‘œì‹œ ì •ìƒ ì‘ë™
  $progress.textContent = `ë¬¸ì œ ${currentIndex+1} / ${words.length}`;
  $feedback.textContent = "";
  $feedback.style.color = "";
  $answer.value = "";
  $nextBtn.style.display = "none";
  attempts = 0;
  typedByKeyboard = false;

  setTimeout(()=>{ $answer.focus(); $answer.setSelectionRange(0,0); }, 0);
}

/* ====== ì±„ì  ====== */
function checkAnswer(){
  const user = $answer.value.trim().toLowerCase();
  const correct = cur().en.toLowerCase();

  if(!typedByKeyboard){ return showWarn("âŒ¨ï¸ ìë™ì™„ì„±/ë¶™ì—¬ë„£ê¸° ê¸ˆì§€: ì§ì ‘ íƒ€ì´í•‘í•˜ì„¸ìš”."); }

  if(user === correct){
    $feedback.textContent = "âœ… ì •ë‹µì…ë‹ˆë‹¤!";
    $feedback.style.color = "green";
    setTimeout(nextQuestion, 650);
  }else{
    attempts++;
    if(attempts >= 3){
      $feedback.innerHTML = `âŒ ì˜¤ë‹µ! ì •ë‹µì€: <b>${cur().en}</b><br>ì •ë‹µì„ <u>ì§ì ‘ íƒ€ì´í•‘</u>í•´ì„œ ë§íˆë©´ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.`;
      $feedback.style.color = "crimson";
      $nextBtn.style.display = "none";
      $answer.focus();
    }else{
      showWarn(`âŒ ì˜¤ë‹µì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„! (ë‚¨ì€ ê¸°íšŒ ${3-attempts}ë²ˆ)`);
    }
  }
}

function showWarn(msg){
  $feedback.textContent = msg;
  $feedback.style.color = "crimson";
}

/* ====== ì§„í–‰/ì¢…ë£Œ ====== */
function nextQuestion(){
  currentIndex++;
  if(currentIndex < words.length) loadQuestion();
  else showFinishScreen();
}

function showFinishScreen(){
  document.getElementById("quiz-box").innerHTML = `
    <h2>ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ë‹¤ í’€ì—ˆìŠµë‹ˆë‹¤. ìˆ˜ê³ í–ˆì–´ìš”!</h2>
    <p style="margin:8px 0 16px;color:#666">ë‹¤ì‹œ ì—°ìŠµí•˜ë©´ ìˆœì„œê°€ ë§¤ë²ˆ ì„ì…ë‹ˆë‹¤.</p>
    <button id="retry2" style="padding:10px 16px;border:none;border-radius:10px;background:#9b59b6;color:#fff;font-size:15px;cursor:pointer;">ë‹¤ì‹œ í’€ê¸°</button>
  `;
  document.getElementById("retry2").addEventListener("click", resetQuiz);
}

/* ====== ë¦¬ì…‹ (ë§¤ë²ˆ ë¬´ì‘ìœ„) ====== */
function resetQuiz(){
  order = [...Array(words.length).keys()];
  shuffle(order);                 // ë§¤ë²ˆ ìƒˆë¡œ ì„ìŒ
  currentIndex = 0;
  attempts = 0;
  typedByKeyboard = false;
  composing = false;

  // ì´ˆê¸° ë ˆì´ì•„ì›ƒ ë³µì›
  document.getElementById("quiz-box").innerHTML = `
    <div id="title">ìŠ¤í ë§ ì…ë ¥ ì—°ìŠµ</div>
    <div id="progress">ë¬¸ì œ 1 / ${words.length}</div>
    <div id="korean"></div>
    <form id="form" autocomplete="off" autocapitalize="off" spellcheck="false">
      <input id="answer" type="text" inputmode="latin" name="no-autofill"
             autocomplete="new-password" autocapitalize="off"
             aria-label="ì˜ì–´ ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" placeholder="ì˜ì–´ ë‹¨ì–´ë¥¼ ì§ì ‘ íƒ€ì´í•‘í•˜ì„¸ìš”" />
      <button type="submit" style="display:none"></button>
    </form>
    <div class="btns">
      <button id="speak" type="button">ğŸ”Š ë°œìŒ ë“£ê¸°</button>
      <button id="check" type="button">ì •ë‹µ í™•ì¸</button>
      <button id="next"  type="button" style="display:none">ë‹¤ìŒ ë¬¸ì œ</button>
      <button id="retry" type="button" style="display:none">ë‹¤ì‹œ í’€ê¸°</button>
    </div>
    <div id="feedback"></div>
    <div class="muted">â€» ìë™ì™„ì„±/ë¶™ì—¬ë„£ê¸°/ë“œë˜ê·¸ ì…ë ¥ì€ ì œí•œë©ë‹ˆë‹¤. ì§ì ‘ íƒ€ì´í•‘í•˜ì„¸ìš”.</div>
  `;
  bindRuntimeElements();          // â˜… ìƒˆ ìš”ì†Œ ë°”ì¸ë”©
  loadQuestion();                 // â˜… ì²« ë¬¸ì œ ë¡œë“œ(í•œêµ­ì–´ í‘œì‹œ)
}

/* ====== ë°œìŒ (ë¬¸ì¥ì½ì–´ì£¼ê¸° ë°©ì‹) ====== */
function speak(text){
  const u = new SpeechSynthesisUtterance();
  u.text = "\u200B " + text;  // ZWSPë¡œ ì²«ì†Œë¦¬ ë³´ê°•
  u.lang = "en-US";
  u.rate = 0.8;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

/* ====== ì‹œì‘ ====== */
shuffle(order);         // ìµœì´ˆë„ ë¬´ì‘ìœ„
bindRuntimeElements();  // ì´ˆê¸° ë°”ì¸ë”©
loadQuestion();         // ì²« ë¬¸ì œ í‘œì‹œ
</script>
</body>
</html>
