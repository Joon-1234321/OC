<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>단어 카드 → 스펠링 → 뜻 맞추기</title>
<style>
  :root{
    --bg:#0b1220; --panel:#0f1b36cc; --text:#e5e7eb;
    --front1:#2563eb; --front2:#22c55e; --ok:#22c55e; --no:#ef4444;
  }
  html,body{
    height:100%;margin:0;
    background:radial-gradient(1200px 700px at 50% -10%, #1b2a55 0%, var(--bg) 60%);
    color:var(--text);
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;
  }
  .wrap{max-width:1100px;margin:0 auto;padding:18px}
  header{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:10px}
  h1{margin:0;font-size:clamp(18px,3vw,26px);font-weight:900}
  .hud{display:flex;gap:10px;flex-wrap:wrap}
  .pill{background:var(--panel);border:1px solid #28406e;padding:8px 12px;border-radius:999px}
  .btn{cursor:pointer;background:#0e1a33;border:1px solid #28406e;color:var(--text);padding:10px 14px;border-radius:12px;font-weight:800}
  .grid{display:grid;grid-template-columns:1.4fr 1fr;gap:14px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
  .cardWrap{perspective:1400px}
  .card{
    position:relative;width:100%;height:min(56vh,520px);
    transform-style:preserve-3d;transition:transform .7s ease;
    border-radius:22px;box-shadow:0 10px 30px #0004;border:1px solid #20345f;
  }
  .card.flip{transform:rotateY(180deg)}
  .face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;
    backface-visibility:hidden;border-radius:22px;padding:22px;text-align:center;}
  .front{background:linear-gradient(135deg,var(--front1),var(--front2));color:white;}
  .word{font-size:clamp(32px,7vw,72px);font-weight:900;text-shadow:0 6px 30px #0006}
  .back{background:linear-gradient(180deg,#0d1834,#091530);transform:rotateY(180deg);}
  .mask{font-size:clamp(28px,6vw,56px);font-weight:900;color:#a7b3d8}
  .panel{background:var(--panel);border:1px solid #28406e;border-radius:16px;padding:14px}

  /* ✅ 보기(뜻) 스타일 — 한 줄, 간격 넓고 얇은 버튼 */
  .choice{
    background:#1a2750;
    border:1px solid #324c7a;
    border-radius:12px;
    padding:14px 16px;
    margin:10px 0;
    cursor:pointer;
    text-align:center;
    font-weight:800;
    color:#f9fafb;
    font-size:clamp(22px,2.5vw,32px);
    transition:all .25s ease;
    white-space: nowrap;
    overflow-wrap: normal;
    height:auto;
    min-height:60px;
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow:0 2px 8px #0003;
  }
  .choice:hover{filter:brightness(1.15);}
  .choice.ok{
    background:#064e3b;border-color:#22c55e;color:#dcfce7;
    animation:flash 0.6s ease-out;
  }
  .choice.no{
    background:#5b1717;border-color:#ef4444;color:#fee2e2;
    animation:shake 0.4s ease-in-out;
  }
  .choices{display:flex;flex-direction:column;align-items:stretch;width:100%;margin-top:14px}
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:22px;background:#0b162ecc;border:1px solid #24407a;
    padding:10px 14px;border-radius:12px;display:none}

  /* ✨ 카드 반짝 효과 */
  @keyframes cardFlash {
    0%{box-shadow:0 0 0px #22c55e;}
    40%{box-shadow:0 0 30px #22c55e;}
    100%{box-shadow:0 0 0px #22c55e;}
  }
  .flash{animation:cardFlash 0.8s ease-out;}

  /* 💥 버튼 흔들림 */
  @keyframes shake {
    0%,100%{transform:translateX(0);}
    20%{transform:translateX(-8px);}
    40%{transform:translateX(8px);}
    60%{transform:translateX(-6px);}
    80%{transform:translateX(6px);}
  }

  /* ✨ 버튼 반짝임 */
  @keyframes flash {
    0%{box-shadow:0 0 0px #22c55e;}
    50%{box-shadow:0 0 20px #22c55e;}
    100%{box-shadow:0 0 0px #22c55e;}
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>단어 카드 → 스펠링 → 뜻 맞추기</h1>
    <div class="hud">
      <div class="pill">단어 <b id="idx">1</b>/<span id="total">11</span></div>
      <div class="pill">정답 <b id="corrects">0</b></div>
      <button class="btn" id="btnReset">↺ 다시하기</button>
    </div>
  </header>

  <div class="grid">
    <section class="cardWrap">
      <div id="card" class="card">
        <!-- 앞면 -->
        <div class="face front">
          <div class="word" id="frontWord">join</div>
          <div>5초 후 카드가 뒤집혀요</div>
        </div>
        <!-- 뒷면 -->
        <div class="face back">
          <div class="mask" id="mask">■■■■</div>
          <div class="panel" style="margin-top:12px;max-width:560px;width:90%">
            <div id="typingStage">
              <form id="spellForm" autocomplete="off" style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
                <input id="spellInput" type="text" placeholder="영어 스펠링" style="flex:1 1 240px;min-width:200px;padding:12px;border-radius:10px;border:1px solid #2b4677;background:#0b1a33;color:white;font-size:18px;font-weight:800">
                <button class="btn" type="submit">확인</button>
              </form>
            </div>
            <div id="mcqStage" style="display:none">
              <div>뜻을 고르세요</div>
              <div id="choices"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
const WORDS=[
  {en:"join",ko:"가입하다"},
  {en:"send",ko:"보내다"},
  {en:"DM",ko:"다이렉트 메세지"},
  {en:"write",ko:"쓰다 기록하다"},
  {en:"subscribe to",ko:"구독하다"},
  {en:"follow",ko:"팔로우하다"},
  {en:"share",ko:"공유하다"},
  {en:"post",ko:"게시하다"},
  {en:"channel",ko:"채널"},
  {en:"account",ko:"계정 계좌"},
  {en:"comment",ko:"댓글 논평"},
];
let idx=0,corrects=0,errors=0,timer=null;
const $=s=>document.querySelector(s);
const card=$("#card"),frontWord=$("#frontWord"),mask=$("#mask"),idxE=$("#idx"),totalE=$("#total"),corE=$("#corrects");
const spellForm=$("#spellForm"),input=$("#spellInput"),typing=$("#typingStage"),mcq=$("#mcqStage"),choices=$("#choices"),toast=$("#toast");

function norm(s){return s.toLowerCase().replace(/[^a-z]/g,"");}
function toastMsg(m,ms=900){toast.textContent=m;toast.style.display="block";setTimeout(()=>toast.style.display="none",ms);}
function speak(t){try{const u=new SpeechSynthesisUtterance("\u200B,\u200B "+t);u.lang="en-US";u.rate=.9;speechSynthesis.cancel();speechSynthesis.speak(u);}catch(e){}}
function hud(){idxE.textContent=idx+1;totalE.textContent=WORDS.length;corE.textContent=corrects;}
function front(){
  card.classList.remove("flip");
  errors=0;
  frontWord.textContent=WORDS[idx].en;
  mask.textContent="■■■■";
  typing.style.display="block";
  mcq.style.display="none";
  input.value="";
  input.disabled=true;
  setTimeout(()=>flip(),5000);
}
function flip(){
  card.classList.add("flip");
  mask.textContent="●".repeat(norm(WORDS[idx].en).length);
  setTimeout(()=>{input.disabled=false;input.focus();},400);
}
spellForm.addEventListener("submit",e=>{
  e.preventDefault();
  const user=norm(input.value),ans=norm(WORDS[idx].en);
  if(user===ans){errors=0;speak(WORDS[idx].en);typing.style.display="none";buildMCQ();}
  else{errors++;toastMsg(`오답 ${errors}회`);if(errors>=2){errors=0;revealAgain();}else input.select();}
});
function revealAgain(){
  card.classList.remove("flip");
  frontWord.textContent=WORDS[idx].en;
  toastMsg("다시 한 번 봅시다 👀",1500);
  speak(WORDS[idx].en);
  setTimeout(()=>{
    card.classList.add("flip");
    input.disabled=false;
    input.focus();
  },2000);
}
function buildMCQ(){
  mcq.style.display="block";
  choices.innerHTML="";
  const correct=WORDS[idx].ko;
  const pool=WORDS.filter((w,i)=>i!==idx).map(w=>w.ko);
  const opts=[correct,...pool.sort(()=>Math.random()-0.5).slice(0,3)].sort(()=>Math.random()-0.5);
  opts.forEach(t=>{
    const b=document.createElement("button");
    b.className="choice";
    b.textContent=t;
    b.onclick=()=>{
      if(t===correct){
        b.classList.add("ok");
        card.classList.add("flash");     // ✅ 카드 반짝 효과
        toastMsg("정답! 다음 단어로");
        corrects++;
        setTimeout(()=>{
          card.classList.remove("flash");
          next();
        },800);
      }else{
        b.classList.add("no");
        toastMsg("다시 선택!");
      }
    };
    choices.append(b);
  });
}
function next(){
  idx++;
  if(idx>=WORDS.length){
    alert(`🎉 완료!\n정답 ${corrects}/${WORDS.length}`);
    reset();
    return;
  }
  hud();
  front();
}
function reset(){
  speechSynthesis.cancel();
  idx=0;corrects=0;
  hud();
  front();
}
window.onload=()=>{
  setTimeout(()=>speechSynthesis.getVoices(),200);
  hud();
  front();
};
</script>
</body>
</html>
